<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transformer 自回归计算过程</title>
    <link rel="stylesheet" href="css/transformer.css">
</head>
<body>
    <div class="container">
        <!-- 顶部独立的返回按钮 -->
        <div class="back-button-container">
            <a href="index.html" class="back-button">← 返回</a>
        </div>
        
        <!-- 步骤控制与标题融合在一起 -->
        <div class="step-controls">
            <div class="step-indicator">
                <span>时间步：</span><span id="currentStep">1</span>
                <span>序列长度：</span><span id="sequenceLength">1</span>
            </div>
            <div class="header">
                <h1>Transformer 自回归计算过程可视化</h1>
            </div>
            <div class="buttons-container">
                <button id="prevStep">上一步</button>
                <button id="nextStep">下一步</button>
            </div>
        </div>

        <!-- 各个组件的容器 -->
        <div id="sequence-container"></div>
        <div id="matrix-container"></div>
        <div id="attention-matrices-container"></div>
        <div id="attention-calculation-container"></div>
        <div id="matrix-multiplication-container"></div>

        <!-- 底部独立的返回按钮 -->
        <div class="footer-back-button">
            <a href="index.html" class="back-button">← 返回</a>
        </div>
    </div>

    <!-- 组件加载脚本 -->
    <script type="module">
        import { loadComponents } from './js/utils/component-loader.js';
        
        // 定义要加载的组件
        const components = [
            { url: './components/sequence-section.html', target: '#sequence-container' },
            { url: './components/matrix-section.html', target: '#matrix-container' },
            { url: './components/attention-matrices.html', target: '#attention-matrices-container' },
            { url: './components/attention-calculation.html', target: '#attention-calculation-container' },
            { url: './components/matrix-multiplication-section.html', target: '#matrix-multiplication-container' }
        ];
        
        // 当DOM加载完成后加载组件
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // 加载所有组件
                await loadComponents(components);
                console.log('所有组件加载完成');
                
                // 加载主控制器
                const { initializeApp } = await import('./js/controller.js');
                initializeApp();
            } catch (error) {
                console.error('组件加载失败:', error);
            }
        });
    </script>
</body>
</html> 